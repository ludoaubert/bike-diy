<html>
<meta charset="UTF-8">
  <head>
    <title>connected rectangles</title>
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	
    <script type="text/javascript" src="imgcomponent.js"></script>
	<link rel="stylesheet" type="text/css" href="imgcomponent.css">
	
   <script>   

//	import contexts from "./contexts.json" assert { type: "json" };
//	import data from "./diagdata.json" assert { type: "json" };

	function onLoad() {
		var Module = {
		  'print': function(text) { console.log('stdout: ' + text) },
		  'printErr': function(text) { console.log('stderr: ' + text) }
		}; 

//		loadDiag(data, contexts);
	
		var data = null;
		var contexts = null;
		var brands = null;
		var componenttypes = null;
		var products = null;
		
		const canLoad = () => data != null && contexts != null && pictures != null && brands != null && componenttypes != null && products != null;
		
		var xmlhttp1 = new XMLHttpRequest();

		xmlhttp1.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				data = this.responseText;
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp1.open("GET", "diagdata.json", true);
		xmlhttp1.send();
		

		var xmlhttp2 = new XMLHttpRequest();

		xmlhttp2.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				contexts = this.responseText;
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp2.open("GET", "contexts.json", true);
		xmlhttp2.send();
		
		var xmlhttp3 = new XMLHttpRequest();

		xmlhttp3.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				pictures = this.responseText;
				console.log(pictures);
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp3.open("GET", "pictures.json", true);
		xmlhttp3.send();
		
		var xmlhttp4 = new XMLHttpRequest();

		xmlhttp4.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				brands = this.responseText;
				console.log(brands);
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp4.open("GET", "brands.json", true);
		xmlhttp4.send();
		
		var xmlhttp5 = new XMLHttpRequest();

		xmlhttp5.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				componenttypes = this.responseText;
				console.log(componenttypes);
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp5.open("GET", "component-types.json", true);
		xmlhttp5.send();
		
		var xmlhttp6 = new XMLHttpRequest();

		xmlhttp6.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				products = this.responseText;
				console.log(products);
				if (canLoad())
					loadDiag(data, contexts);
			}
		};
		xmlhttp6.open("GET", "products.json", true);
		xmlhttp6.send();
	}
    </script>
	
    <script type="text/javascript" src="bombix-origine.js"></script>
	<script type="text/javascript" src="pretty.js"></script>
	<script type="text/javascript" src="iocomponent.js"></script>
	<link rel="stylesheet" type="text/css" href="iocomponent.css">
    <script type="text/javascript" src="diagload.js"></script>
    <link rel="stylesheet" type="text/css" href="diagstyle.css">	
  </head>
  
  <body onload="onLoad()">

  </body>
</html>
